<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N2 단어 게임</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            font-family: 'Noto Sans JP', 'Noto Sans KR', sans-serif;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            min-height: 100vh;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 2rem;
            font-size: 2.5rem;
        }

        #game-container {
            width: 100%;
            max-width: 800px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }

        .menu {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            background-color: #3498db;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 1.1rem;
            min-width: 120px;
        }

        button:hover {
            background-color: #2980b9;
        }

        #toggleAutoStudyMode {
            background-color: #1abc9c;
        }

        #toggleAutoStudyMode:hover {
            background-color: #16a085;
        }


        .section {
            margin-top: 1rem;
            background-color: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .hidden {
            display: none;
        }

        .card {
            background-color: #ffffff;
            padding: 2rem 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            margin-bottom: 1.5rem;
            text-align: center;
            min-height: 220px;
            position: relative;
            perspective: 1000px; /* For 3D effect, though transition is removed in auto mode */
        }

        .word-front, .word-back {
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; /* Default transition */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: white; /* Ensure background for covering */
            border-radius: 10px; /* Match card's border radius */
            backface-visibility: hidden; /* Hide the back of the element during rotation */
        }

        /* CSS to disable transition when auto mode is active */
        .card.auto-mode-active .word-front,
        .card.auto-mode-active .word-back {
            transition: none !important; 
        }

        .word-back.hidden {
            opacity: 0;
            pointer-events: none; /* Prevent interaction when hidden */
            transform: rotateY(180deg); /* Rotate away */
        }
        .word-front.hidden {
            opacity: 0;
            pointer-events: none; /* Prevent interaction when hidden */
            transform: rotateY(-180deg); /* Rotate away */
        }


        #wordJapanese {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            color: #333;
        }

        #wordReading {
            font-size: 1.8rem;
            color: #555;
            margin-bottom: 0.8rem;
        }

        #wordKorean {
            font-size: 1.6rem;
            color: #2c3e50;
        }

        .quiz-container, .write-container {
            text-align: center;
            padding: 1rem 0;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.8rem;
            margin: 1.5rem 0;
        }

        .option {
            padding: 0.8rem;
            font-size: 1.1rem;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            color: #333; /* 객관식 보기 글자색 수정 */
        }
        .option:hover {
            background-color: #e9e9e9;
        }


        #result, #writeResult {
            font-size: 1.2rem;
            margin: 1rem 0;
            font-weight: bold;
            min-height: 40px; /* To prevent layout shift */
        }

        .score {
            text-align: center;
            font-size: 1.2rem;
            margin-top: 1rem;
            color: #333;
        }


        #writeWord {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
        }

        .answer-input {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        #userAnswer {
            padding: 0.8rem 1.2rem;
            font-size: 1.1rem;
            border: 2px solid #3498db;
            border-radius: 5px;
            flex-grow: 1;
            max-width: 350px;
            outline: none;
        }

        #userAnswer:focus {
            border-color: #2980b9;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
        }
        
        .answer-input button {
            flex-grow: 0; /* Prevent button from growing too much */
        }

        /* Auto 모드 속도 조절 UI 스타일 */
        .speed-control-container {
            margin-top: 1rem;
            display: flex;
            flex-direction: column; /* 세로 정렬 */
            align-items: center;
            gap: 0.5rem;
        }
        .speed-control-container label {
            font-size: 0.9rem;
            color: #555;
        }
        .speed-control-container input[type="range"] {
            width: 80%;
            max-width: 250px;
            cursor: pointer;
        }
        #currentSpeedLabel {
            font-size: 0.9rem;
            color: #333;
            min-width: 30px; /* 숫자 변경 시 레이아웃 흔들림 방지 */
            text-align: center;
        }
        .speed-label-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            .menu button {
                font-size: 1rem;
                padding: 0.7rem 1.2rem;
            }
            #wordJapanese, #writeWord {
                font-size: 3rem;
            }
            #wordReading {
                font-size: 1.6rem;
            }
            #wordKorean {
                font-size: 1.5rem;
            }
        }


        @media (max-width: 600px) {
            body {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
                margin-bottom: 1.5rem;
            }
            #game-container {
                padding: 1.5rem;
            }

            .menu {
                gap: 0.5rem;
            }
            .menu button {
                width: calc(50% - 0.25rem); /* Two buttons per row with gap */
                margin-bottom: 0.5rem;
                font-size: 0.9rem;
                padding: 0.6rem 1rem;
            }
            /* If odd number of buttons, make the last one full width */
            .menu button:last-child:nth-child(odd) {
                width: 100%;
            }


            .card {
                padding: 1.5rem 1rem;
                min-height: 180px;
            }

            #wordJapanese, #writeWord {
                font-size: 2.5rem;
            }

            #wordReading {
                font-size: 1.3rem;
            }

            #wordKorean {
                font-size: 1.2rem;
            }

            .options {
                grid-template-columns: 1fr; /* Single column for options */
                gap: 0.5rem;
            }
            .option {
                font-size: 1rem;
            }

            .answer-input {
                flex-direction: column;
                align-items: stretch;
            }
            #userAnswer {
                max-width: none; /* Allow full width */
                width: 100%;
                margin-bottom: 0.5rem;
            }
            .answer-input button {
                width: 100%;
            }

            /* Make study/quiz buttons full width on small screens */
            #studySection button, 
            #quizSection #nextQuiz, 
            #writeSection #nextWriteQuiz {
                width: 100%;
                margin-top: 0.5rem;
            }
            /* Remove top margin for the first button in study section if it's full width */
            #studySection button:first-of-type {
                margin-top: 0;
            }
            .speed-control-container input[type="range"] {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>JLPT N2 단어 게임</h1>
    <div id="game-container">
        </div>

    <script>
        // words.js content
        const words = [
            // 추상적 개념, 사고방식
            { japanese: "解明", reading: "かいめい", korean: "해명, 규명" },
            { japanese: "概略", reading: "がいりゃく", korean: "개략, 대강" },
            { japanese: "看過", reading: "かんか", korean: "간과" },
            { japanese: "危惧", reading: "きぐ", korean: "우려, 걱정" },
            { japanese: "強要", reading: "きょうよう", korean: "강요" },
            { japanese: "軽視", reading: "けいし", korean: "경시" },
            { japanese: "顕著", reading: "けんちょ", korean: "현저, 뚜렷함" },
            { japanese: "懸念", reading: "けねん", korean: "우려, 걱정" },
            { japanese: "克服", reading: "こくふく", korean: "극복" },
            { japanese: "是正", reading: "ぜせい", korean: "시정, 바로잡음" },
            { japanese: "措置", reading: "そち", korean: "조치" },
            { japanese: "妥協", reading: "だきょう", korean: "타협" },
            { japanese: "打開", reading: "だかい", korean: "타개, 돌파" },
            { japanese: "端的", reading: "たんてき", korean: "단적, 간단명료" },
            { japanese: "着眼", reading: "ちゃくがん", korean: "착안" },
            { japanese: "追究", reading: "ついきゅう", korean: "추구, 규명" },
            { japanese: "踏襲", reading: "とうしゅう", korean: "답습" },
            { japanese: "把握", reading: "はあく", korean: "파악" },
            { japanese: "反映", reading: "はんえい", korean: "반영" },
            { japanese: "斟酌", reading: "しんしゃく", korean: "참작" },
            // 행동, 대응
            { japanese: "阻止", reading: "そし", korean: "저지, 방해" },
            { japanese: "遂行", reading: "すいこう", korean: "수행" },
            { japanese: "是認", reading: "ぜにん", korean: "시인, 승인" },
            { japanese: "占有", reading: "せんゆう", korean: "점유" },
            { japanese: "阻害", reading: "そがい", korean: "저해" },
            { japanese: "遵守", reading: "じゅんしゅ", korean: "준수" },
            { japanese: "譲歩", reading: "じょうほ", korean: "양보" },
            { japanese: "醸成", reading: "じょうせい", korean: "양성, 배양" },
            { japanese: "堅持", reading: "けんじ", korean: "견지" },
            { japanese: "携帯", reading: "けいたい", korean: "휴대" },
            // 상태, 상황
            { japanese: "窮地", reading: "きゅうち", korean: "궁지" },
            { japanese: "混沌", reading: "こんとん", korean: "혼돈" },
            { japanese: "錯覚", reading: "さっかく", korean: "착각" },
            { japanese: "支障", reading: "ししょう", korean: "지장" },
            { japanese: "至難", reading: "しなん", korean: "지난, 매우 어려움" },
            { japanese: "衰退", reading: "すいたい", korean: "쇠퇴" },
            { japanese: "停滞", reading: "ていたい", korean: "정체" },
            { japanese: "途絶", reading: "とぜつ", korean: "도절, 끊김" },
            { japanese: "難航", reading: "なんこう", korean: "난항" },
            { japanese: "膠着", reading: "こうちゃく", korean: "교착, 정체" },
            // 성질, 특성
            { japanese: "希薄", reading: "きはく", korean: "희박" },
            { japanese: "巧妙", reading: "こうみょう", korean: "교묘" },
            { japanese: "稚拙", reading: "ちせつ", korean: "치졸" },
            { japanese: "微妙", reading: "びみょう", korean: "미묘" },
            { japanese: "漠然", reading: "ばくぜん", korean: "막연" },
            { japanese: "曖昧", reading: "あいまい", korean: "애매" },
            { japanese: "緻密", reading: "ちみつ", korean: "치밀" },
            { japanese: "頑固", reading: "がんこ", korean: "완고" },
            { japanese: "謙虚", reading: "けんきょ", korean: "겸허" },
            { japanese: "潔白", reading: "けっぱく", korean: "결백" },
            // 비즈니스/경제 용어
            { japanese: "需要", reading: "じゅよう", korean: "수요" },
            { japanese: "供給", reading: "きょうきゅう", korean: "공급" },
            { japanese: "収支", reading: "しゅうし", korean: "수지" },
            { japanese: "採算", reading: "さいさん", korean: "채산" },
            { japanese: "査定", reading: "さてい", korean: "사정, 평가" },
            { japanese: "着手", reading: "ちゃくしゅ", korean: "착수" },
            { japanese: "着実", reading: "ちゃくじつ", korean: "착실" },
            { japanese: "撤退", reading: "てったい", korean: "철수, 철회" },
            { japanese: "提携", reading: "ていけい", korean: "제휴" },
            { japanese: "統括", reading: "とうかつ", korean: "통괄" },
            { japanese: "伸縮", reading: "しんしゅく", korean: "신축" },
            { japanese: "折衝", reading: "せっしょう", korean: "절충, 교섭" },
            { japanese: "促進", reading: "そくしん", korean: "촉진" },
            { japanese: "損失", reading: "そんしつ", korean: "손실" },
            // 사회/정치 용어
            { japanese: "施策", reading: "しさく", korean: "시책" },
            { japanese: "是非", reading: "ぜひ", korean: "시비" },
            { japanese: "擁護", reading: "ようご", korean: "옹호" },
            { japanese: "介入", reading: "かいにゅう", korean: "개입" },
            { japanese: "規制", reading: "きせい", korean: "규제" },
            { japanese: "規約", reading: "きやく", korean: "규약" },
            { japanese: "強制", reading: "きょうせい", korean: "강제" },
            { japanese: "拘束", reading: "こうそく", korean: "구속" },
            { japanese: "抗議", reading: "こうぎ", korean: "항의" },
            { japanese: "施行", reading: "しこう", korean: "시행" },
            // 감정/심리 용어
            { japanese: "憤慨", reading: "ふんがい", korean: "분개" },
            { japanese: "焦燥", reading: "しょうそう", korean: "초조" },
            { japanese: "憂慮", reading: "ゆうりょ", korean: "우려" },
            { japanese: "羨望", reading: "せんぼう", korean: "선망" },
            { japanese: "嫉妬", reading: "しっと", korean: "질투" },
            { japanese: "憧憬", reading: "しょうけい", korean: "동경" },
            { japanese: "懇願", reading: "こんがん", korean: "간원" },
            { japanese: "我慢", reading: "がまん", korean: "인내" },
            { japanese: "後悔", reading: "こうかい", korean: "후회" },
            { japanese: "困惑", reading: "こんわく", korean: "곤혹" },
            // 행동/태도
            { japanese: "躊躇", reading: "ちゅうちょ", korean: "주저" },
            { japanese: "執着", reading: "しゅうちゃく", korean: "집착" },
            { japanese: "固執", reading: "こしつ", korean: "고집" },
            { japanese: "傾倒", reading: "けいとう", korean: "경도" },
            { japanese: "憤る", reading: "いきどおる", korean: "분노하다" },
            { japanese: "焦る", reading: "あせる", korean: "초조해하다" },
            { japanese: "諦める", reading: "あきらめる", korean: "포기하다" },
            { japanese: "謙遜", reading: "けんそん", korean: "겸손" },
            { japanese: "慎重", reading: "しんちょう", korean: "신중" },
            { japanese: "率直", reading: "そっちょく", korean: "솔직" },
            // 학술/연구 용어
            { japanese: "仮説", reading: "かせつ", korean: "가설" },
            { japanese: "検証", reading: "けんしょう", korean: "검증" },
            { japanese: "分析", reading: "ぶんせき", korean: "분석" },
            { japanese: "考察", reading: "こうさつ", korean: "고찰" },
            { japanese: "推測", reading: "すいそく", korean: "추측" },
            { japanese: "推定", reading: "すいてい", korean: "추정" },
            { japanese: "証明", reading: "しょうめい", korean: "증명" },
            { japanese: "解析", reading: "かいせき", korean: "해석" },
            { japanese: "論理", reading: "ろんり", korean: "논리" },
            { japanese: "批評", reading: "ひひょう", korean: "비평" },
            { japanese: "評価", reading: "ひょうか", korean: "평가" },
            { japanese: "解釈", reading: "かいしゃく", korean: "해석" },
            { japanese: "観察", reading: "かんさつ", korean: "관찰" },
            { japanese: "調査", reading: "ちょうさ", korean: "조사" },
            { japanese: "実験", reading: "じっけん", korean: "실험" },
            // 환경/자연 용어
            { japanese: "浸食", reading: "しんしょく", korean: "침식" },
            { japanese: "堆積", reading: "たいせき", korean: "퇴적" },
            { japanese: "汚染", reading: "おせん", korean: "오염" },
            { japanese: "排出", reading: "はいしゅつ", korean: "배출" },
            { japanese: "保護", reading: "ほご", korean: "보호" },
            { japanese: "繁殖", reading: "はんしょく", korean: "번식" },
            { japanese: "生態", reading: "せいたい", korean: "생태" },
            { japanese: "絶滅", reading: "ぜつめつ", korean: "절멸" },
            { japanese: "進化", reading: "しんか", korean: "진화" },
            { japanese: "適応", reading: "てきおう", korean: "적응" },
            // 의료/건강 용어
            { japanese: "診察", reading: "しんさつ", korean: "진찰" },
            { japanese: "治療", reading: "ちりょう", korean: "치료" },
            { japanese: "予防", reading: "よぼう", korean: "예방" },
            { japanese: "症状", reading: "しょうじょう", korean: "증상" },
            { japanese: "悪化", reading: "あっか", korean: "악화" },
            { japanese: "改善", reading: "かいぜん", korean: "개선" },
            { japanese: "投薬", reading: "とうやく", korean: "투약" },
            { japanese: "摂取", reading: "せっしゅ", korean: "섭취" },
            { japanese: "衛生", reading: "えいせい", korean: "위생" },
            { japanese: "感染", reading: "かんせん", korean: "감염" },
            // 문화/예술 용어
            { japanese: "芸術", reading: "げいじゅつ", korean: "예술" },
            { japanese: "表象", reading: "ひょうしょう", korean: "표상" },
            { japanese: "象徴", reading: "しょうちょう", korean: "상징" },
            { japanese: "抽象", reading: "ちゅうしょう", korean: "추상" },
            { japanese: "創造", reading: "そうぞう", korean: "창조" },
            { japanese: "継承", reading: "けいしょう", korean: "계승" },
            { japanese: "伝統", reading: "でんとう", korean: "전통" },
            { japanese: "風習", reading: "ふうしゅう", korean: "풍습" },
            { japanese: "慣習", reading: "かんしゅう", korean: "관습" },
            { japanese: "儀式", reading: "ぎしき", korean: "의식" },
            // 법률/제도 용어
            { japanese: "規範", reading: "きはん", korean: "규범" },
            { japanese: "制度", reading: "せいど", korean: "제도" },
            { japanese: "違反", reading: "いはん", korean: "위반" },
            { japanese: "規則", reading: "きそく", korean: "규칙" },
            { japanese: "条例", reading: "じょうれい", korean: "조례" },
            { japanese: "制定", reading: "せいてい", korean: "제정" },
            { japanese: "改正", reading: "かいせい", korean: "개정" },
            { japanese: "廃止", reading: "はいし", korean: "폐지" },
            // 기술/과학 용어
            { japanese: "開発", reading: "かいはつ", korean: "개발" }, 
            { japanese: "技術", reading: "ぎじゅつ", korean: "기술" },
            { japanese: "革新", reading: "かくしん", korean: "혁신" },
            { japanese: "進歩", reading: "しんぽ", korean: "진보" },
            { japanese: "発明", reading: "はつめい", korean: "발명" },
            { japanese: "応用", reading: "おうよう", korean: "응용" },
            { japanese: "効率", reading: "こうりつ", korean: "효율" },
            { japanese: "機能", reading: "きのう", korean: "기능" },
            { japanese: "設計", reading: "せっけい", korean: "설계" },
            { japanese: "構造", reading: "こうぞう", korean: "구조" },
            // 심리/철학 용어
            { japanese: "意識", reading: "いしき", korean: "의식" },
            { japanese: "認識", reading: "にんしき", korean: "인식" },
            { japanese: "思考", reading: "しこう", korean: "사고" },
            { japanese: "概念", reading: "がいねん", korean: "개념" },
            { japanese: "本質", reading: "ほんしつ", korean: "본질" },
            { japanese: "存在", reading: "そんざい", korean: "존재" },
            { japanese: "価値", reading: "かち", korean: "가치" },
            { japanese: "理念", reading: "りねん", korean: "이념" },
            { japanese: "真理", reading: "しんり", korean: "진리" },
            { japanese: "倫理", reading: "りんり", korean: "윤리" },
            // 교육/학습 용어
            { japanese: "習得", reading: "しゅうとく", korean: "습득" }, 
            { japanese: "理解", reading: "りかい", korean: "이해" }, 
            { japanese: "修得", reading: "しゅうとく", korean: "수득" }, 
            { japanese: "教養", reading: "きょうよう", korean: "교양" }, 
            { japanese: "指導", reading: "しどう", korean: "지도" },
            { japanese: "育成", reading: "いくせい", korean: "육성" },
            { japanese: "啓発", reading: "けいはつ", korean: "계발" },
            { japanese: "研修", reading: "けんしゅう", korean: "연수" },
            { japanese: "講義", reading: "こうぎ", korean: "강의" },
            { japanese: "課程", reading: "かてい", korean: "과정" }, 
            // 경제/금융 용어
            { japanese: "投資", reading: "とうし", korean: "투자" },
            { japanese: "融資", reading: "ゆうし", korean: "융자" },
            { japanese: "株式", reading: "かぶしき", korean: "주식" },
            { japanese: "資産", reading: "しさん", korean: "자산" },
            { japanese: "負債", reading: "ふさい", korean: "부채" },
            { japanese: "収益", reading: "しゅうえき", korean: "수익" },
            { japanese: "損益", reading: "そんえき", korean: "손익" },
            { japanese: "予算", reading: "よさん", korean: "예산" },
            { japanese: "財政", reading: "ざいせい", korean: "재정" },
            { japanese: "経営", reading: "けいえい", korean: "경영" },
            // 미디어/커뮤니케이션 용어
            { japanese: "報道", reading: "ほうどう", korean: "보도" },
            { japanese: "広告", reading: "こうこく", korean: "광고" },
            { japanese: "宣伝", reading: "せんでん", korean: "선전" },
            { japanese: "放送", reading: "ほうそう", korean: "방송" },
            { japanese: "配信", reading: "はいしん", korean: "배신 (配信)" }, 
            { japanese: "編集", reading: "へんしゅう", korean: "편집" },
            { japanese: "掲載", reading: "けいさい", korean: "게재" },
            { japanese: "発信", reading: "はっしん", korean: "발신" },
            { japanese: "受信", reading: "じゅしん", korean: "수신" },
            { japanese: "通信", reading: "つうしん", korean: "통신" },
            // 조직/인사 용어
            { japanese: "採用", reading: "さいよう", korean: "채용" },
            { japanese: "昇進", reading: "しょうしん", korean: "승진" },
            { japanese: "異動", reading: "いどう", korean: "이동" },
            { japanese: "配置", reading: "はいち", korean: "배치" },
            { japanese: "退職", reading: "たいしょく", korean: "퇴직" },
            { japanese: "解雇", reading: "かいこ", korean: "해고" },
            { japanese: "待遇", reading: "たいぐう", korean: "대우" },
            { japanese: "給与", reading: "きゅうよ", korean: "급여" },
            { japanese: "福利", reading: "ふくり", korean: "복리" },
            { japanese: "厚生", reading: "こうせい", korean: "후생" },
            // 정치/외교 용어
            { japanese: "政策", reading: "せいさく", korean: "정책" },
            { japanese: "外交", reading: "がいこう", korean: "외교" },
            { japanese: "協定", reading: "きょうてい", korean: "협정" },
            { japanese: "条約", reading: "じょうやく", korean: "조약" },
            { japanese: "議会", reading: "ぎかい", korean: "의회" },
            { japanese: "選挙", reading: "せんきょ", korean: "선거" },
            { japanese: "投票", reading: "とうひょう", korean: "투표" },
            { japanese: "与党", reading: "よとう", korean: "여당" },
            { japanese: "野党", reading: "やとう", korean: "야당" },
            { japanese: "内閣", reading: "ないかく", korean: "내각" },
            // 산업/제조 용어
            { japanese: "製造", reading: "せいぞう", korean: "제조" },
            { japanese: "加工", reading: "かこう", korean: "가공" },
            { japanese: "組立", reading: "くみたて", korean: "조립" },
            { japanese: "品質", reading: "ひんしつ", korean: "품질" },
            { japanese: "検査", reading: "けんさ", korean: "검사" },
            { japanese: "保守", reading: "ほしゅ", korean: "보수" }, 
            { japanese: "修理", reading: "しゅうり", korean: "수리" },
            { japanese: "部品", reading: "ぶひん", korean: "부품" },
            { japanese: "原料", reading: "げんりょう", korean: "원료" },
            { japanese: "資材", reading: "しざい", korean: "자재" },
            // 도시/건설 용어
            { japanese: "建設", reading: "けんせつ", korean: "건설" },
            { japanese: "整備", reading: "せいび", korean: "정비" },
            { japanese: "改築", reading: "かいちく", korean: "개축" },
            { japanese: "補修", reading: "ほしゅう", korean: "보수" }, 
            { japanese: "設備", reading: "せつび", korean: "설비" },
            { japanese: "施設", reading: "しせつ", korean: "시설" },
            { japanese: "計画", reading: "けいかく", korean: "계획" },
            { japanese: "区画", reading: "くかく", korean: "구획" },
            { japanese: "用地", reading: "ようち", korean: "용지" },
            // 안전/보안 용어
            { japanese: "安全", reading: "あんぜん", korean: "안전" },
            { japanese: "防災", reading: "ぼうさい", korean: "방재" },
            { japanese: "警備", reading: "けいび", korean: "경비" },
            { japanese: "監視", reading: "かんし", korean: "감시" },
            { japanese: "対策", reading: "たいさく", korean: "대책" },
            { japanese: "管理", reading: "かんり", korean: "관리" },
            { japanese: "点検", reading: "てんけん", korean: "점검" },
            { japanese: "危機", reading: "きき", korean: "위기" },
            // 비즈니스 관계 용어
            { japanese: "取引", reading: "とりひき", korean: "거래" },
            { japanese: "契約", reading: "けいやく", korean: "계약" },
            { japanese: "納入", reading: "のうにゅう", korean: "납입" },
            { japanese: "仕入れ", reading: "しいれ", korean: "매입" },
            { japanese: "売上", reading: "うりあげ", korean: "매출" },
            { japanese: "発注", reading: "はっちゅう", korean: "발주" },
            { japanese: "受注", reading: "じゅちゅう", korean: "수주" },
            { japanese: "納品", reading: "のうひん", korean: "납품" },
            { japanese: "決済", reading: "けっさい", korean: "결제" },
            { japanese: "精算", reading: "せいさん", korean: "정산" },
            // 사회 문제 용어
            { japanese: "格差", reading: "かくさ", korean: "격차" },
            { japanese: "差別", reading: "さべつ", korean: "차별" },
            { japanese: "偏見", reading: "へんけん", korean: "편견" },
            { japanese: "貧困", reading: "ひんこん", korean: "빈곤" },
            { japanese: "失業", reading: "しつぎょう", korean: "실업" },
            { japanese: "過労", reading: "かろう", korean: "과로" },
            { japanese: "孤独", reading: "こどく", korean: "고독" },
            { japanese: "疎外", reading: "そがい", korean: "소외" },
            { japanese: "虐待", reading: "ぎゃくたい", korean: "학대" },
            { japanese: "暴力", reading: "ぼうりょく", korean: "폭력" },
            // 환경 문제 용어
            { japanese: "温暖化", reading: "おんだんか", korean: "온난화" },
            { japanese: "廃棄", reading: "はいき", korean: "폐기" },
            { japanese: "再生", reading: "さいせい", korean: "재생" },
            { japanese: "節約", reading: "せつやく", korean: "절약" },
            { japanese: "保全", reading: "ほぜん", korean: "보전" },
            { japanese: "破壊", reading: "はかい", korean: "파괴" },
            { japanese: "浄化", reading: "じょうか", korean: "정화" },
            { japanese: "排水", reading: "はいすい", korean: "배수" },
            { japanese: "省エネ", reading: "しょうエネ", korean: "에너지 절약" },
            // 심리 상태 용어
            { japanese: "不安", reading: "ふあん", korean: "불안" },
            { japanese: "緊張", reading: "きんちょう", korean: "긴장" },
            { japanese: "焦り", reading: "あせり", korean: "초조" }, 
            { japanese: "落ち込み", reading: "おちこみ", korean: "침체" },
            { japanese: "憂鬱", reading: "ゆううつ", korean: "우울" },
            { japanese: "苛立ち", reading: "いらだち", korean: "짜증" },
            { japanese: "恐怖", reading: "きょうふ", korean: "공포" },
            { japanese: "嫌悪", reading: "けんお", korean: "혐오" },
            { japanese: "羞恥", reading: "しゅうち", korean: "수치" },
            { japanese: "悔しさ", reading: "くやしさ", korean: "분함" },
            // 행동 특성 용어
            { japanese: "大胆", reading: "だいたん", korean: "대담" },
            { japanese: "几帳面", reading: "きちょうめん", korean: "꼼꼼함" },
            { japanese: "粗末", reading: "そまつ", korean: "조잡" }, 
            { japanese: "丁寧", reading: "ていねい", korean: "정중" },
            { japanese: "雑", reading: "ざつ", korean: "조잡" },
            { japanese: "傲慢", reading: "ごうまん", korean: "오만" },
            { japanese: "勤勉", reading: "きんべん", korean: "근면" },
            { japanese: "怠惰", reading: "たいだ", korean: "태만" },
            // 학술 연구 용어 (추가)
            { japanese: "検討", reading: "けんとう", korean: "검토" },
            { japanese: "実証", reading: "じっしょう", korean: "실증" },
            { japanese: "論証", reading: "ろんしょう", korean: "논증" },
            { japanese: "推論", reading: "すいろん", korean: "추론" },
            { japanese: "仮定", reading: "かてい", korean: "가정" }, 
            { japanese: "結論", reading: "けつろん", korean: "결론" },
            // 비즈니스 성과 용어
            { japanese: "実績", reading: "じっせき", korean: "실적" },
            { japanese: "成果", reading: "せいか", korean: "성과" },
            { japanese: "業績", reading: "ぎょうせき", korean: "업적" },
            { japanese: "達成", reading: "たっせい", korean: "달성" },
            { japanese: "向上", reading: "こうじょう", korean: "향상" },
            { japanese: "進展", reading: "しんてん", korean: "진전" },
            { japanese: "発展", reading: "はってん", korean: "발전" },
            { japanese: "成長", reading: "せいちょう", korean: "성장" },
            { japanese: "拡大", reading: "かくだい", korean: "확대" },
            // 문제 해결 용어
            { japanese: "解決", reading: "かいけつ", korean: "해결" },
            { japanese: "対処", reading: "たいしょ", korean: "대처" },
            { japanese: "防止", reading: "ぼうし", korean: "방지" },
            { japanese: "回避", reading: "かいひ", korean: "회피" },
            { japanese: "排除", reading: "はいじょ", korean: "배제" },
            // 조직 관리 용어
            { japanese: "管轄", reading: "かんかつ", korean: "관할" },
            { japanese: "監督", reading: "かんとく", korean: "감독" },
            { japanese: "指揮", reading: "しき", korean: "지휘" }, 
            { japanese: "運営", reading: "うんえい", korean: "운영" },
            { japanese: "調整", reading: "ちょうせい", korean: "조정" },
            { japanese: "指示", reading: "しじ", korean: "지시" },
            { japanese: "命令", reading: "めいれい", korean: "명령" },
            { japanese: "監査", reading: "かんさ", korean: "감사" }, 
            // 평가/판단 용어
            { japanese: "判断", reading: "はんだん", korean: "판단" },
            { japanese: "審査", reading: "しんさ", korean: "심사" },
            { japanese: "鑑定", reading: "かんてい", korean: "감정" },
            { japanese: "診断", reading: "しんだん", korean: "진단" },
            { japanese: "批判", reading: "ひはん", korean: "비판" },
            { japanese: "吟味", reading: "ぎんみ", korean: "음미" },
            // 인간관계 용어
            { japanese: "信頼", reading: "しんらい", korean: "신뢰" },
            { japanese: "尊敬", reading: "そんけい", korean: "존경" },
            { japanese: "親密", reading: "しんみつ", korean: "친밀" },
            { japanese: "疎遠", reading: "そえん", korean: "소원" }, 
            { japanese: "協調", reading: "きょうちょう", korean: "협조" },
            { japanese: "対立", reading: "たいりつ", korean: "대립" },
            { japanese: "和解", reading: "わかい", korean: "화해" },
            { japanese: "仲介", reading: "ちゅうかい", korean: "중개" },
            { japanese: "調和", reading: "ちょうわ", korean: "조화" },
            { japanese: "共存", reading: "きょうそん", korean: "공존" },

            // 성격/성품 용어
            { japanese: "温厚", reading: "おんこう", korean: "온후" },
            { japanese: "寛容", reading: "かんよう", korean: "관용" },
            { japanese: "誠実", reading: "せいじつ", korean: "성실" },
            { japanese: "柔軟", reading: "じゅうなん", korean: "유연" },
            { japanese: "積極", reading: "せっきょく", korean: "적극" },
            { japanese: "消極", reading: "しょうきょく", korean: "소극" },

            // 사회생활 용어
            { japanese: "順応", reading: "じゅんのう", korean: "순응" },
            { japanese: "自立", reading: "じりつ", korean: "자립" },
            { japanese: "依存", reading: "いそん", korean: "의존" }, 
            { japanese: "協力", reading: "きょうりょく", korean: "협력" },
            { japanese: "競争", reading: "きょうそう", korean: "경쟁" },
            { japanese: "貢献", reading: "こうけん", korean: "공헌" },
            { japanese: "奉仕", reading: "ほうし", korean: "봉사" },
            { japanese: "参加", reading: "さんか", korean: "참가" },
            { japanese: "交流", reading: "こうりゅう", korean: "교류" },

            // 학습/교육 용어 (추가)
            { japanese: "習熟", reading: "しゅうじゅく", korean: "숙달" },
            { japanese: "暗記", reading: "あんき", korean: "암기" },
            { japanese: "復習", reading: "ふくしゅう", korean: "복습" },
            { japanese: "予習", reading: "よしゅう", korean: "예습" },
            { japanese: "会得", reading: "えとく", korean: "회득" },
            { japanese: "体得", reading: "たいとく", korean: "체득" },

            // 사고/판단 용어 (추가)
            { japanese: "思索", reading: "しさく", korean: "사색" }, 
            { japanese: "熟考", reading: "じゅっこう", korean: "숙고" },
            { japanese: "予測", reading: "よそく", korean: "예측" },
            { japanese: "判定", reading: "はんてい", korean: "판정" },
            { japanese: "決定", reading: "けってい", korean: "결정" },
            { japanese: "選択", reading: "せんたく", korean: "선택" },
            { japanese: "決断", reading: "けつだん", korean: "결단" },

            // 감정/기분 용어 (추가)
            { japanese: "感動", reading: "かんどう", korean: "감동" },
            { japanese: "感激", reading: "かんげき", korean: "감격" },
            { japanese: "興奮", reading: "こうふん", korean: "흥분" },
            { japanese: "落胆", reading: "らくたん", korean: "낙담" },
            { japanese: "絶望", reading: "ぜつぼう", korean: "절망" },
            { japanese: "満足", reading: "まんぞく", korean: "만족" },
            { japanese: "不満", reading: "ふまん", korean: "불만" },
            { japanese: "安心", reading: "あんしん", korean: "안심" },

            // 행동/태도 용어 (추가)
            { japanese: "態度", reading: "たいど", korean: "태도" },
            { japanese: "振舞", reading: "ふるまい", korean: "처신" },
            { japanese: "行動", reading: "こうどう", korean: "행동" },
            { japanese: "対応", reading: "たいおう", korean: "대응" },
            { japanese: "反応", reading: "はんのう", korean: "반응" },
            { japanese: "立場", reading: "たちば", korean: "입장" }, 
            { japanese: "様子", reading: "ようす", korean: "모습" },
            { japanese: "状態", reading: "じょうたい", korean: "상태" },

            // 변화/발전 용어
            { japanese: "変化", reading: "へんか", korean: "변화" },
            { japanese: "後退", reading: "こうたい", korean: "후퇴" },

            // 시간/과정 용어
            { japanese: "経過", reading: "けいか", korean: "경과" },
            { japanese: "進行", reading: "しんこう", korean: "진행" },
            { japanese: "展開", reading: "てんかい", korean: "전개" },
            { japanese: "継続", reading: "けいぞく", korean: "계속" },
            { japanese: "持続", reading: "じぞく", korean: "지속" },
            { japanese: "延長", reading: "えんちょう", korean: "연장" },
            { japanese: "短縮", reading: "たんしゅく", korean: "단축" },
            { japanese: "中断", reading: "ちゅうだん", korean: "중단" },

            // 목표/계획 용어
            { japanese: "目標", reading: "もくひょう", korean: "목표" },
            { japanese: "目的", reading: "もくてき", korean: "목적" },
            { japanese: "予定", reading: "よてい", korean: "예정" },
            { japanese: "方針", reading: "ほうしん", korean: "방침" },
            { japanese: "戦略", reading: "せんりゃく", korean: "전략" },
            { japanese: "構想", reading: "こうそう", korean: "구상" },
            { japanese: "企画", reading: "きかく", korean: "기획" },
            { japanese: "立案", reading: "りつあん", korean: "입안" },
            { japanese: "設定", reading: "せってい", korean: "설정" },

            // 결과/성과 용어
            { japanese: "結果", reading: "けっか", korean: "결과" },
            { japanese: "効果", reading: "こうか", korean: "효과" },
            { japanese: "影響", reading: "えいきょう", korean: "영향" },
            { japanese: "完成", reading: "かんせい", korean: "완성" },
            { japanese: "完了", reading: "かんりょう", korean: "완료" },
            { japanese: "終了", reading: "しゅうりょう", korean: "종료" },

            // 문제/해결 용어 (추가)
            { japanese: "問題", reading: "もんだい", korean: "문제" },
            { japanese: "課題", reading: "かだい", korean: "과제" },
            { japanese: "難題", reading: "なんだい", korean: "난제" },
            { japanese: "障害", reading: "しょうがい", korean: "장애" },
            { japanese: "解消", reading: "かいしょう", korean: "해소" },

            // 조직/체계 용어
            { japanese: "組織", reading: "そしき", korean: "조직" },
            { japanese: "体制", reading: "たいせい", korean: "체제" },
            { japanese: "機構", reading: "きこう", korean: "기구" },
            { japanese: "体系", reading: "たいけい", korean: "체계" },
            { japanese: "規模", reading: "きぼ", korean: "규모" },
            { japanese: "規定", reading: "きてい", korean: "규정" },
            { japanese: "基準", reading: "きじゅん", korean: "기준" },

            // 능력/실력 용어
            { japanese: "能力", reading: "のうりょく", korean: "능력" },
            { japanese: "実力", reading: "じつりょく", korean: "실력" },
            { japanese: "技能", reading: "ぎのう", korean: "기능" }, 
            { japanese: "才能", reading: "さいのう", korean: "재능" },
            { japanese: "資質", reading: "ししつ", korean: "자질" }, 
            { japanese: "素質", reading: "そしつ", korean: "소질" },
            { japanese: "適性", reading: "てきせい", korean: "적성" },
            { japanese: "力量", reading: "りきりょう", korean: "역량" }, 
            { japanese: "専門", reading: "せんもん", korean: "전문" },

            // 의견/주장 용어
            { japanese: "意見", reading: "いけん", korean: "의견" },
            { japanese: "主張", reading: "しゅちょう", korean: "주장" },
            { japanese: "見解", reading: "けんかい", korean: "견해" },
            { japanese: "観点", reading: "かんてん", korean: "관점" },
            { japanese: "視点", reading: "してん", korean: "시점" },
            { japanese: "論点", reading: "ろんてん", korean: "논점" },
            { japanese: "提案", reading: "ていあん", korean: "제안" },
            { japanese: "提言", reading: "ていげん", korean: "제언" },
            { japanese: "助言", reading: "じょげん", korean: "조언" },

            // N4/N5 단어를 다음 N2 단어로 대체 (기존 목록 유지 및 일부 중복 확인)
            { japanese: "安堵", reading: "あんど", korean: "안도" },
            { japanese: "充足", reading: "じゅうそく", korean: "충족" },
            { japanese: "予備", reading: "よび", korean: "예비" },
            { japanese: "復元", reading: "ふくげん", korean: "복원" },
            { japanese: "記憶", reading: "きおく", korean: "기억" },
            { japanese: "姿勢", reading: "しせい", korean: "자세" },
            { japanese: "状況", reading: "じょうきょう", korean: "상황" },
            { japanese: "参画", reading: "さんかく", korean: "참획" }, 
            { japanese: "裁定", reading: "さいてい", korean: "재정(裁定)" }, 
            { japanese: "抜粋", reading: "ばっすい", korean: "발췌" },
            // 추가 N4/N5 단어를 다음 N2 단어로 대체 (기존 목록 유지)
            { japanese: "所為", reading: "しょい", korean: "소위" }, 
            { japanese: "様態", reading: "ようたい", korean: "양태" }, 
            { japanese: "推移", reading: "すいい", korean: "추이" },
            { japanese: "趣旨", reading: "しゅし", korean: "취지" },
            { japanese: "企図", reading: "きと", korean: "기도(企図)" }, 
            { japanese: "帰結", reading: "きけつ", korean: "귀결" },
            { japanese: "技倆", reading: "ぎりょう", korean: "기량" }, 
        ];
    </script>

    <script>
        // script.js content
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('game-container');
            // Dynamically create the game's HTML structure
            container.innerHTML = `
                <div class="menu">
                    <button id="studyMode">학습 모드</button>
                    <button id="quizMode">객관식 퀴즈</button>
                    <button id="writeMode">주관식 퀴즈</button>
                </div>
                <div id="studySection" class="section">
                    <div class="card">
                        <div class="word-front">
                            <h2 id="wordJapanese"></h2>
                        </div>
                        <div class="word-back hidden">
                            <p id="wordReading"></p>
                            <p id="wordKorean"></p>
                        </div>
                    </div>
                    <div class="speed-control-container">
                        <div class="speed-label-container">
                            <label for="autoModeSpeed">Auto 모드 속도:</label>
                            <span id="currentSpeedLabel">3</span>초
                        </div>
                        <input type="range" id="autoModeSpeed" min="1" max="5" value="3">
                    </div>
                    <button id="nextWord">다음 단어</button>
                    <button id="flipCard">카드 뒤집기</button>
                    <button id="toggleAutoStudyMode">Auto 모드 시작</button>
                </div>
                <div id="quizSection" class="section hidden">
                    <div class="quiz-container">
                        <h2 id="quizWord"></h2>
                        <div class="options"></div>
                        <p id="result"></p>
                        <button id="nextQuiz" class="hidden">다음 문제</button>
                    </div>
                    <div class="score">
                        맞은 개수: <span id="correctCount">0</span> / <span id="totalCount">0</span>
                    </div>
                </div>
                <div id="writeSection" class="section hidden">
                    <div class="write-container">
                        <h2 id="writeWord"></h2>
                        <div class="answer-input">
                            <input type="text" id="userAnswer" placeholder="한글 뜻을 입력하세요">
                            <button id="checkAnswer">정답 확인</button>
                        </div>
                        <p id="writeResult"></p>
                        <button id="nextWriteQuiz" class="hidden">다음 문제</button>
                    </div>
                    <div class="score">
                        맞은 개수: <span id="writeCorrectCount">0</span> / <span id="writeTotalCount">0</span>
                    </div>
                </div>
            `;

            setupEventListeners();
            showStudyMode(); // Initialize with study mode
        });

        let currentWordIndex = 0;
        let score = 0;
        let totalQuestions = 0;

        let autoModeInterval = null;
        let isAutoModeRunning = false;
        // AUTO_MODE_FRONT_DURATION and AUTO_MODE_BACK_DURATION are dynamically set based on slider

        function setupEventListeners() {
            document.getElementById('studyMode').addEventListener('click', showStudyMode);
            document.getElementById('quizMode').addEventListener('click', showQuizMode);
            document.getElementById('writeMode').addEventListener('click', showWriteMode);
            
            const nextWordButton = document.getElementById('nextWord');
            nextWordButton.addEventListener('click', () => {
                if(isAutoModeRunning) { // If auto mode is running, stop it first
                    stopAutoMode();
                }
                showNextWord();
            });

            const flipCardButton = document.getElementById('flipCard');
            flipCardButton.addEventListener('click', () => {
                if(isAutoModeRunning) { // If auto mode is running, stop it first
                    stopAutoMode();
                }
                flipCard();
            });

            document.getElementById('toggleAutoStudyMode').addEventListener('click', toggleAutoStudy);

            const autoModeSpeedSlider = document.getElementById('autoModeSpeed');
            const currentSpeedLabel = document.getElementById('currentSpeedLabel');
            if (autoModeSpeedSlider && currentSpeedLabel) {
                autoModeSpeedSlider.addEventListener('input', (event) => {
                    currentSpeedLabel.textContent = event.target.value;
                    // If auto mode is running, restart it with the new speed
                    if (isAutoModeRunning) {
                        stopAutoMode(); // Stop current timer
                        startAutoMode(); // Restart with new speed (maintains button text etc.)
                    }
                });
            }


            document.getElementById('nextQuiz').addEventListener('click', showNextQuiz);
            document.getElementById('checkAnswer').addEventListener('click', checkWriteAnswer);
            document.getElementById('nextWriteQuiz').addEventListener('click', showNextWriteQuiz);
            
            // Add Enter key listener for 주관식 퀴즈
            const userAnswerInput = document.getElementById('userAnswer');
            if (userAnswerInput) {
                 userAnswerInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const nextButton = document.getElementById('nextWriteQuiz');
                        // If "다음 문제" button is visible, Enter triggers it
                        if (nextButton && !nextButton.classList.contains('hidden')) {
                            showNextWriteQuiz();
                        } else { // Otherwise, Enter triggers "정답 확인"
                            checkWriteAnswer();
                        }
                    }
                });
            }
        }

        function toggleAutoStudy() {
            if (isAutoModeRunning) {
                stopAutoMode();
            } else {
                startAutoMode();
            }
        }

        function startAutoMode() {
            if (isAutoModeRunning) return; // Already running

            // Ensure study section is visible and card is ready
            if (document.getElementById('studySection').classList.contains('hidden')) {
                showStudyMode(); // Switch to study mode if not already
            } else {
                // If card back is shown, flip to front first for consistent start
                const wordBack = document.querySelector('#studySection .word-back');
                if (wordBack && !wordBack.classList.contains('hidden')) { 
                    flipCard(); 
                } else if (!document.getElementById('wordJapanese').textContent) { 
                    // If no word is displayed, show one
                    showNextWord(); 
                }
            }
            
            isAutoModeRunning = true;
            document.getElementById('toggleAutoStudyMode').textContent = 'Auto 모드 중지';
            document.getElementById('nextWord').disabled = true;
            document.getElementById('flipCard').disabled = true;
            document.getElementById('autoModeSpeed').disabled = true; // Disable speed slider during auto mode

            // Add class to card to disable transitions
            const cardElement = document.querySelector('#studySection .card');
            if (cardElement) {
                cardElement.classList.add('auto-mode-active');
            }

            let showBackNext = true; // Determines if the next action is to show back or next word
            const selectedSpeed = parseInt(document.getElementById('autoModeSpeed').value) * 1000; // Convert seconds to milliseconds

            function autoLoop() {
                if (!isAutoModeRunning) return; // Stop if auto mode was turned off

                if (showBackNext) {
                    flipCard(); // Show back of the card
                    showBackNext = false;
                    autoModeInterval = setTimeout(autoLoop, selectedSpeed); // Wait for selectedSpeed
                } else {
                    showNextWord(); // Show next word (front of the card)
                    showBackNext = true;
                    autoModeInterval = setTimeout(autoLoop, selectedSpeed); // Wait for selectedSpeed
                }
            }
            
            // Initial call to start the loop
            // Ensure the card front is showing before starting the timed flip
            if (document.querySelector('#studySection .word-front:not(.hidden)')) { 
                showBackNext = true; // Next action is to show back
                autoModeInterval = setTimeout(autoLoop, selectedSpeed);
            } else { // If back is showing or card is in an intermediate state, reset and start
                showNextWord(); // Show a new word (front)
                showBackNext = true;
                autoModeInterval = setTimeout(autoLoop, selectedSpeed);
            }
        }

        function stopAutoMode() {
            if (autoModeInterval) {
                clearTimeout(autoModeInterval);
                autoModeInterval = null;
            }
            if (isAutoModeRunning) {
                isAutoModeRunning = false;
                const autoStudyButton = document.getElementById('toggleAutoStudyMode');
                if (autoStudyButton) {
                    autoStudyButton.textContent = 'Auto 모드 시작';
                }
                const nextWordButton = document.getElementById('nextWord');
                if (nextWordButton) nextWordButton.disabled = false;
                const flipCardButton = document.getElementById('flipCard');
                if (flipCardButton) flipCardButton.disabled = false;
                const autoModeSpeedSlider = document.getElementById('autoModeSpeed');
                if (autoModeSpeedSlider) autoModeSpeedSlider.disabled = false; // Enable speed slider

                // Remove class from card to re-enable transitions
                const cardElement = document.querySelector('#studySection .card');
                if (cardElement) {
                    cardElement.classList.remove('auto-mode-active');
                }
            }
        }

        function showStudyMode() {
            stopAutoMode(); // Stop auto mode if it's running
            hideAllSections();
            document.getElementById('studySection').classList.remove('hidden');
            showNextWord(); // Display the first word
        }

        function showNextWord() {
            currentWordIndex = Math.floor(Math.random() * words.length);
            const word = words[currentWordIndex];
            document.getElementById('wordJapanese').textContent = word.japanese;
            document.getElementById('wordReading').textContent = `읽는 법: ${word.reading}`;
            document.getElementById('wordKorean').textContent = `뜻: ${word.korean}`;
            
            // Ensure card front is shown and back is hidden
            document.querySelector('#studySection .word-front').classList.remove('hidden');
            document.querySelector('#studySection .word-back').classList.add('hidden');
        }

        function flipCard() {
            document.querySelector('#studySection .word-front').classList.toggle('hidden');
            document.querySelector('#studySection .word-back').classList.toggle('hidden');
        }

        function showQuizMode() {
            stopAutoMode(); // Stop auto mode if it's running
            hideAllSections();
            document.getElementById('quizSection').classList.remove('hidden');
            score = 0;
            totalQuestions = 0;
            updateScore();
            showNextQuiz();
        }

        function showNextQuiz() {
            const optionsContainer = document.querySelector('#quizSection .options');
            optionsContainer.innerHTML = ''; // Clear previous options
            document.getElementById('result').textContent = '';
            document.getElementById('nextQuiz').classList.add('hidden');

            currentWordIndex = Math.floor(Math.random() * words.length);
            const correctWord = words[currentWordIndex];
            document.getElementById('quizWord').textContent = correctWord.japanese;

            const answers = getRandomAnswers(correctWord);
            answers.forEach(answer => {
                const button = document.createElement('button');
                button.textContent = answer.korean;
                button.classList.add('option');
                button.addEventListener('click', () => checkAnswer(button, answer.korean, correctWord));
                optionsContainer.appendChild(button);
            });
        }

        function showWriteMode() {
            stopAutoMode(); // Stop auto mode if it's running
            hideAllSections();
            document.getElementById('writeSection').classList.remove('hidden');
            score = 0;
            totalQuestions = 0;
            updateWriteScore();
            showNextWriteQuiz();
        }

        function showNextWriteQuiz() {
            currentWordIndex = Math.floor(Math.random() * words.length);
            const word = words[currentWordIndex];
            document.getElementById('writeWord').textContent = word.japanese;
            const userAnswerInput = document.getElementById('userAnswer');
            if (userAnswerInput) userAnswerInput.value = ''; // Clear previous answer
            document.getElementById('writeResult').textContent = '';
            document.getElementById('nextWriteQuiz').classList.add('hidden');
            if (userAnswerInput) userAnswerInput.focus(); // Focus on input field
        }

        function checkWriteAnswer() {
            const userAnswerInput = document.getElementById('userAnswer');
            if (!userAnswerInput) return;

            const userAnswer = userAnswerInput.value.trim();
            const correctAnswer = words[currentWordIndex].korean;
            const reading = words[currentWordIndex].reading;
            const resultElement = document.getElementById('writeResult');

            if (userAnswer === correctAnswer) {
                resultElement.textContent = `정답입니다! (읽는 법: ${reading})`;
                resultElement.style.color = '#4CAF50'; // Green for correct
                score++;
            } else {
                resultElement.textContent = `틀렸습니다. 정답은 "${correctAnswer}" (읽는 법: ${reading}) 입니다.`;
                resultElement.style.color = '#f44336'; // Red for incorrect
            }
            totalQuestions++;
            updateWriteScore();
            document.getElementById('nextWriteQuiz').classList.remove('hidden');
        }

        function hideAllSections() {
            document.getElementById('studySection').classList.add('hidden');
            document.getElementById('quizSection').classList.add('hidden');
            document.getElementById('writeSection').classList.add('hidden');
        }

        function updateScore() {
            document.getElementById('correctCount').textContent = score;
            document.getElementById('totalCount').textContent = totalQuestions;
        }

        function updateWriteScore() {
            document.getElementById('writeCorrectCount').textContent = score;
            document.getElementById('writeTotalCount').textContent = totalQuestions;
        }

        function getRandomAnswers(correctWord) {
            const answers = [{ korean: correctWord.korean, reading: correctWord.reading }];
            const usedIndices = new Set([currentWordIndex]); // Keep track of used words to avoid duplicates

            while (answers.length < 4) { // We need 3 more incorrect answers
                const randomIndex = Math.floor(Math.random() * words.length);
                if (!usedIndices.has(randomIndex)) { // Ensure the word is not the correct one or already picked
                    const randomWord = words[randomIndex];
                    answers.push({ korean: randomWord.korean, reading: randomWord.reading });
                    usedIndices.add(randomIndex);
                }
            }
            return shuffleArray(answers); // Shuffle the answers
        }
        
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
            return array;
        }

        function checkAnswer(buttonElement, selectedAnswer, correctWord) {
            const optionButtons = document.querySelectorAll('#quizSection .option');
            const resultElement = document.getElementById('result');
            
            // Disable all option buttons after an answer is selected
            optionButtons.forEach(option => option.disabled = true); 
            
            if (selectedAnswer === correctWord.korean) {
                buttonElement.style.backgroundColor = '#4CAF50'; // Green for correct
                resultElement.innerHTML = `정답입니다!<br><span style="font-size: 0.9em; color: #666;">읽는 법: ${correctWord.reading}</span>`;
                resultElement.style.color = '#4CAF50';
                score++;
            } else {
                buttonElement.style.backgroundColor = '#f44336'; // Red for incorrect
                // Highlight the correct answer
                optionButtons.forEach(option => { 
                    if (option.textContent === correctWord.korean) {
                        option.style.backgroundColor = '#4CAF50';
                    }
                });
                resultElement.innerHTML = `틀렸습니다.<br><span style="font-size: 0.9em; color: #666;">읽는 법: ${correctWord.reading}</span>`;
                resultElement.style.color = '#f44336';
            }
            
            totalQuestions++;
            updateScore();
            document.getElementById('nextQuiz').classList.remove('hidden'); // Show "다음 문제" button
        }
    </script>
</body>
</html>
